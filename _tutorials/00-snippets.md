---
title: Snippets
modified: 2020-12-02T22:28:32+00:00
---

Before you can access any of the Tekla Open API objects, you will need to initialize the connection between Tekla Structures and your application.

Because applications are not started together with Tekla Structures they cannot expect to have Tekla Structures running upon execution.

In this guide we go trough two ways of checking if the Tekla Structures is running and a model is open.

Check the connection using model.GetConnectionStatus();

```csharp
// Create a new instance of Model class. 
Model model = new Model();

// check if connection has succeeded?
if (model.GetConnectionStatus())
{ 
    // TODO: write code here 
}
```

For drawings, the following creates a new instance to the drawings object:

```csharp
DrawingHandler CurrentDrawingHandler = new DrawingHandler();
```

In this guide we explain how to iterate through model and drawing objects in the current model or drawing.

For models, use the class ModelObjectEnumerator and for drawings, DrawingObjectEnumerator.

Enumerate model objects
The ModelObjectEnumerator class provides the means to iterate through model object instances in the current model.

This example shows how to enumerate all selected objects of Beam type and get the solid information of the beams.

```csharp
ModelObjectEnumerator Enum = myModel.GetModelObjectSelector().GetAllObjects();

while (Enum.MoveNext())
{
    Beam B = Enum.Current as Beam;
    if (B != null)
    {
        Solid Solid = B.GetSolid();
    }
}
```

## Enumerate drawing objects
The DrawingObjectEnumerator class provides the means to iterate through drawing object instances. Drawing object enumerators are generated by the container view and they contain drawing objects that are children of the container view instance.

This example shows how to enumerate all selected objects in the current drawing and delete them.

```csharp
Drawing CurrentDrawing = CurrentDrawingHandler.GetActiveDrawing();

DrawingObjectEnumerator AllObjects = CurrentDrawing.GetSheet().GetAllObjects();

while (AllObjects.MoveNext())
{
    if (AllObjects.Current is Line)
    {
        AllObjects.Current.Delete();
    }
}
```

[link](https://developer.tekla.com/tekla-structures/documentation/creating-applications)